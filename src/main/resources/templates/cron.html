<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cron í‘œí˜„ì‹ ë„êµ¬ - Playground</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        .cron-container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .cron-section {
            background: white;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .input-group {
            margin-bottom: 1rem;
        }
        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #495057;
        }
        .input-group input, .input-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 1rem;
        }
        .result-box {
            background: #e9ecef;
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
        }
        .result-label {
            font-weight: 500;
            color: #495057;
            margin-bottom: 0.5rem;
        }
        .result-value {
            background: white;
            padding: 0.75rem;
            border-radius: 4px;
            font-family: monospace;
            margin-bottom: 0.5rem;
        }
        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        .grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 1rem;
        }
        .helper-text {
            font-size: 0.85rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }
        .examples {
            background: #d1ecf1;
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
        }
        .examples h4 {
            margin-top: 0;
            color: #0c5460;
        }
        .example-item {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem;
            margin: 0.25rem 0;
            background: white;
            border-radius: 3px;
        }
        .example-expr {
            font-family: monospace;
            color: #007bff;
        }
        .example-desc {
            color: #495057;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <h1 class="logo">Playground</h1>
            <ul class="nav-menu">
                <li th:each="menu : ${menus}">
                    <a th:href="@{${menu.path}}" 
                       th:text="${menu.name}"
                       th:classappend="${currentPage == 'cron-expression'} ? 'active' : ''">
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <main class="container">
        <div class="cron-container">
            <h2>â±ï¸ Cron í‘œí˜„ì‹ ë„êµ¬</h2>
            <p class="description">Cron í‘œí˜„ì‹ì„ ë¶„ì„í•˜ê±°ë‚˜ ìƒì„±í•©ë‹ˆë‹¤.</p>

            <!-- Cron Expression Parser -->
            <div class="cron-section">
                <h3>Cron í‘œí˜„ì‹ â†’ ì„¤ëª…</h3>
                <div class="input-group">
                    <label>Cron í‘œí˜„ì‹ ì…ë ¥</label>
                    <input type="text" id="cronInput" placeholder="ì˜ˆ: 0 0 12 * * ?">
                    <div class="helper-text">Spring Cron (6í•„ë“œ) ë˜ëŠ” Unix Cron (5í•„ë“œ) ì§€ì›</div>
                </div>
                <button class="btn btn-primary" onclick="describeCron()">ë¶„ì„í•˜ê¸°</button>
                <div id="describeResult" style="display: none;">
                    <div class="result-box">
                        <div class="result-label">í‘œí˜„ì‹</div>
                        <div class="result-value" id="resultExpression"></div>
                        <div class="result-label">íƒ€ì…</div>
                        <div class="result-value" id="resultType"></div>
                        <div class="result-label">ì„¤ëª…</div>
                        <div class="result-value" id="resultDescription"></div>
                    </div>
                </div>
            </div>

            <!-- Cron Expression Generator -->
            <div class="cron-section">
                <h3>Cron í‘œí˜„ì‹ ìƒì„±ê¸°</h3>
                <div class="input-group">
                    <label>íƒ€ì… ì„ íƒ</label>
                    <select id="cronType" onchange="toggleSecondField()">
                        <option value="spring">Spring Cron (6 í•„ë“œ)</option>
                        <option value="unix">Unix Cron (5 í•„ë“œ)</option>
                    </select>
                </div>
                
                <div class="grid-3">
                    <div class="input-group" id="secondField">
                        <label>ì´ˆ (0-59)</label>
                        <input type="text" id="second" placeholder="* or 0">
                    </div>
                    <div class="input-group">
                        <label>ë¶„ (0-59)</label>
                        <input type="text" id="minute" placeholder="* or 0">
                    </div>
                    <div class="input-group">
                        <label>ì‹œ (0-23)</label>
                        <input type="text" id="hour" placeholder="* or 0">
                    </div>
                </div>
                
                <div class="grid-3">
                    <div class="input-group">
                        <label>ì¼ (1-31)</label>
                        <input type="text" id="day" placeholder="* or 1">
                    </div>
                    <div class="input-group">
                        <label>ì›” (1-12)</label>
                        <input type="text" id="month" placeholder="* or 1">
                    </div>
                    <div class="input-group">
                        <label>ìš”ì¼ (0-7)</label>
                        <input type="text" id="weekday" placeholder="* or ? or 0">
                        <div class="helper-text">0,7=ì¼ìš”ì¼, 1=ì›”ìš”ì¼</div>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="generateCron()">ìƒì„±í•˜ê¸°</button>
                <div id="generateResult" style="display: none;">
                    <div class="result-box">
                        <div class="result-label">ìƒì„±ëœ Cron í‘œí˜„ì‹</div>
                        <div class="result-value" id="generatedExpression"></div>
                    </div>
                </div>
            </div>

            <!-- Examples -->
            <div class="examples">
                <h4>ğŸ“Œ Cron í‘œí˜„ì‹ ì˜ˆì œ</h4>
                <div class="example-item">
                    <span class="example-expr">0 0 12 * * ?</span>
                    <span class="example-desc">ë§¤ì¼ ì •ì˜¤ 12ì‹œ</span>
                </div>
                <div class="example-item">
                    <span class="example-expr">0 */15 * * * ?</span>
                    <span class="example-desc">15ë¶„ë§ˆë‹¤</span>
                </div>
                <div class="example-item">
                    <span class="example-expr">0 0 9-18 * * MON-FRI</span>
                    <span class="example-desc">í‰ì¼ 9ì‹œ~18ì‹œ ë§¤ ì‹œê°„</span>
                </div>
                <div class="example-item">
                    <span class="example-expr">0 0 0 1 * ?</span>
                    <span class="example-desc">ë§¤ì›” 1ì¼ ìì •</span>
                </div>
                <div class="example-item">
                    <span class="example-expr">0 0 2 * * SUN</span>
                    <span class="example-desc">ë§¤ì£¼ ì¼ìš”ì¼ ìƒˆë²½ 2ì‹œ</span>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 Playground. All rights reserved.</p>
        </div>
    </footer>

    <script>
        function toggleSecondField() {
            const cronType = document.getElementById('cronType').value;
            const secondField = document.getElementById('secondField');
            secondField.style.display = cronType === 'spring' ? 'block' : 'none';
        }

        async function describeCron() {
            const expression = document.getElementById('cronInput').value;
            
            if (!expression) {
                alert('Cron í‘œí˜„ì‹ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }
            
            try {
                const response = await fetch('/cron-expression/api/describe', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ expression: expression })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('resultExpression').textContent = data.expression;
                    document.getElementById('resultType').textContent = data.type;
                    document.getElementById('resultDescription').textContent = data.description;
                    document.getElementById('describeResult').style.display = 'block';
                } else {
                    alert(data.message);
                }
            } catch (error) {
                console.error('ë¶„ì„ ì˜¤ë¥˜:', error);
                alert('ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        async function generateCron() {
            const type = document.getElementById('cronType').value;
            const second = document.getElementById('second').value;
            const minute = document.getElementById('minute').value;
            const hour = document.getElementById('hour').value;
            const day = document.getElementById('day').value;
            const month = document.getElementById('month').value;
            const weekday = document.getElementById('weekday').value;
            
            try {
                const params = new URLSearchParams({
                    type: type,
                    second: second || '',
                    minute: minute || '',
                    hour: hour || '',
                    day: day || '',
                    month: month || '',
                    weekday: weekday || ''
                });
                
                const response = await fetch(`/cron-expression/api/generate?${params}`, {
                    method: 'POST'
                });
                
                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('generatedExpression').textContent = data.expression;
                    document.getElementById('generateResult').style.display = 'block';
                } else {
                    alert(data.message);
                }
            } catch (error) {
                console.error('ìƒì„± ì˜¤ë¥˜:', error);
                alert('ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
    </script>
</body>
</html>
