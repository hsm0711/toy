<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>Encode / Decode</title>
    <th:block layout:fragment="extra-css">
        <link rel="stylesheet" th:href="@{/css/tool-page.css}">
        <style>
            .tab-buttons {
                display: flex;
                gap: 0.5rem;
                margin-bottom: 1.5rem;
            }
            .tab-btn {
                padding: 0.75rem 1.5rem;
                border: none;
                background: white;
                cursor: pointer;
                border-radius: 4px;
                font-weight: 500;
                transition: all 0.3s;
            }
            .tab-btn.active {
                background: #667eea;
                color: white;
            }
            .tab-content {
                display: none;
                background: white;
                padding: 1.5rem;
                border-radius: 6px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .tab-content.active {
                display: block;
            }
            .text-area-group label {
                display: block;
                margin-bottom: 0.5rem;
                font-weight: 500;
                color: #495057;
            }
            .text-area-group textarea {
                width: 100%;
                min-height: 150px;
                padding: 0.75rem;
                border: 1px solid #ced4da;
                border-radius: 4px;
                font-size: 1rem;
                font-family: monospace;
                resize: vertical;
            }
        </style>
    </th:block>
</head>
<body>
    <div layout:fragment="content">
        <div class="tool-container">
            <div class="page-header">
                <h2>ğŸ” Encode / Decode ë„êµ¬</h2>
                <p class="description">Base64, URL, HTML ì¸ì½”ë”©/ë””ì½”ë”©ì„ ì§€ì›í•©ë‹ˆë‹¤.</p>
            </div>

            <div class="tab-buttons">
                <button class="tab-btn active" onclick="switchTab('base64')">Base64</button>
                <button class="tab-btn" onclick="switchTab('url')">URL</button>
                <button class="tab-btn" onclick="switchTab('html')">HTML</button>
            </div>

            <!-- Base64 Tab -->
            <div id="base64Tab" class="tab-content active">
                <h3>Base64 ì¸ì½”ë”©/ë””ì½”ë”©</h3>
                <div class="text-area-group">
                    <label>ì›ë³¸ í…ìŠ¤íŠ¸</label>
                    <textarea id="base64Input" placeholder="ì¸ì½”ë”©í•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="base64Encode()">Encode</button>
                    <button class="btn btn-secondary" onclick="base64Decode()">Decode</button>
                    <button class="clear-btn" onclick="clearBase64()">Clear</button>
                </div>
                <div class="text-area-group">
                    <label>ê²°ê³¼</label>
                    <textarea id="base64Output" readonly></textarea>
                </div>
                <button class="copy-btn" onclick="copyToClipboard('base64Output')">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
            </div>

            <!-- URL Tab -->
            <div id="urlTab" class="tab-content">
                <h3>URL ì¸ì½”ë”©/ë””ì½”ë”©</h3>
                <div class="text-area-group">
                    <label>ì›ë³¸ í…ìŠ¤íŠ¸</label>
                    <textarea id="urlInput" placeholder="ì¸ì½”ë”©í•  URLì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="urlEncode()">Encode</button>
                    <button class="btn btn-secondary" onclick="urlDecode()">Decode</button>
                    <button class="clear-btn" onclick="clearUrl()">Clear</button>
                </div>
                <div class="text-area-group">
                    <label>ê²°ê³¼</label>
                    <textarea id="urlOutput" readonly></textarea>
                </div>
                <button class="copy-btn" onclick="copyToClipboard('urlOutput')">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
            </div>

            <!-- HTML Tab -->
            <div id="htmlTab" class="tab-content">
                <h3>HTML Escape/Unescape</h3>
                <div class="text-area-group">
                    <label>ì›ë³¸ í…ìŠ¤íŠ¸</label>
                    <textarea id="htmlInput" placeholder="ë³€í™˜í•  HTMLì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                </div>
                <div class="button-group">
                    <button class="btn btn-primary" onclick="htmlEscape()">Escape</button>
                    <button class="btn btn-secondary" onclick="htmlUnescape()">Unescape</button>
                    <button class="clear-btn" onclick="clearHtml()">Clear</button>
                </div>
                <div class="text-area-group">
                    <label>ê²°ê³¼</label>
                    <textarea id="htmlOutput" readonly></textarea>
                </div>
                <button class="copy-btn" onclick="copyToClipboard('htmlOutput')">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
            </div>
        </div>
    </div>

    <th:block layout:fragment="extra-js">
        <script>
            function switchTab(tabName) {
                document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                event.target.classList.add('active');
                document.getElementById(tabName + 'Tab').classList.add('active');
            }

            async function callApi(endpoint, input) {
                try {
                    const response = await fetch(endpoint, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ input: input })
                    });
                    return await response.json();
                } catch (error) {
                    console.error('API í˜¸ì¶œ ì˜¤ë¥˜:', error);
                    return { success: false, message: 'ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.' };
                }
            }

            async function base64Encode() {
                const input = document.getElementById('base64Input').value;
                const data = await callApi('/encode-decode/api/base64-encode', input);
                if (data.success) {
                    document.getElementById('base64Output').value = data.result;
                } else {
                    alert(data.message);
                }
            }

            async function base64Decode() {
                const input = document.getElementById('base64Input').value;
                const data = await callApi('/encode-decode/api/base64-decode', input);
                if (data.success) {
                    document.getElementById('base64Output').value = data.result;
                } else {
                    alert(data.message);
                }
            }

            async function urlEncode() {
                const input = document.getElementById('urlInput').value;
                const data = await callApi('/encode-decode/api/url-encode', input);
                if (data.success) {
                    document.getElementById('urlOutput').value = data.result;
                } else {
                    alert(data.message);
                }
            }

            async function urlDecode() {
                const input = document.getElementById('urlInput').value;
                const data = await callApi('/encode-decode/api/url-decode', input);
                if (data.success) {
                    document.getElementById('urlOutput').value = data.result;
                } else {
                    alert(data.message);
                }
            }

            async function htmlEscape() {
                const input = document.getElementById('htmlInput').value;
                const data = await callApi('/encode-decode/api/html-escape', input);
                if (data.success) {
                    document.getElementById('htmlOutput').value = data.result;
                } else {
                    alert(data.message);
                }
            }

            async function htmlUnescape() {
                const input = document.getElementById('htmlInput').value;
                const data = await callApi('/encode-decode/api/html-unescape', input);
                if (data.success) {
                    document.getElementById('htmlOutput').value = data.result;
                } else {
                    alert(data.message);
                }
            }

            function clearBase64() {
                document.getElementById('base64Input').value = '';
                document.getElementById('base64Output').value = '';
            }

            function clearUrl() {
                document.getElementById('urlInput').value = '';
                document.getElementById('urlOutput').value = '';
            }

            function clearHtml() {
                document.getElementById('htmlInput').value = '';
                document.getElementById('htmlOutput').value = '';
            }

            function copyToClipboard(elementId) {
                const textarea = document.getElementById(elementId);
                textarea.select();
                document.execCommand('copy');
                alert('ë³µì‚¬í–ˆìŠµë‹ˆë‹¤!');
            }
        </script>
    </th:block>
</body>
</html>