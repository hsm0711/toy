<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title layout:title-pattern="$CONTENT_TITLE - $LAYOUT_TITLE">Playground</title>
    
    <!-- ê³µí†µ CSS -->
    <link rel="stylesheet" th:href="@{/css/common.css}">
    
    <!-- íŽ˜ì´ì§€ë³„ CSS -->
    <th:block layout:fragment="extra-css"></th:block>
    <link rel="icon" type="image/svg+xml" th:href="@{/image/favicon.svg}">
</head>
<body>
    <!-- ëª¨ë°”ì¼ ë©”ë‰´ ì˜¤ë²„ë ˆì´ -->
    <div class="menu-overlay" id="menuOverlay"></div>

    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <nav class="navbar">
        <div class="nav-container">
            <!-- ë¡œê³  -->
            <div class="nav-logo">
                <a th:href="@{/}" aria-label="í™ˆìœ¼ë¡œ ê°€ê¸°">ðŸŽ® Playground</a>
            </div>
            
            <!-- í–„ë²„ê±° ë²„íŠ¼ -->
            <button class="hamburger" id="hamburgerBtn" aria-label="ë©”ë‰´ ì—´ê¸°" aria-expanded="false">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>
            
            <!-- ë©”ë‰´ -->
            <div class="nav-menu" id="navMenu">
                <ul class="nav-list">
                    <th:block th:if="${menus != null and !menus.isEmpty()}">
                        <li th:each="menu : ${menus}" class="nav-item">
                            <a th:href="@{${menu.path}}" 
                               class="nav-link"
                               th:classappend="${(menu.path == '/' && currentPage == 'home') || (menu.path.length() > 1 && currentPage == menu.path.substring(1))} ? 'active' : ''"
                               th:attr="aria-current=${(menu.path == '/' && currentPage == 'home') || (menu.path.length() > 1 && currentPage == menu.path.substring(1))} ? 'page' : null">
                                <span th:if="${menu.icon != null and menu.icon != ''}" th:text="${menu.icon}"></span>
                                <span th:text="${menu.name}"></span>
                            </a>
                        </li>
                    </th:block>
                </ul>
            </div>
        </div>
    </nav>

    <!-- ë©”ì¸ ì»¨í…ì¸  -->
    <main class="main-content" role="main">
        <div layout:fragment="content">
            <!-- íŽ˜ì´ì§€ë³„ ì»¨í…ì¸  -->
        </div>
    </main>

    <!-- í‘¸í„° -->
    <footer class="footer" role="contentinfo">
        <div class="footer-container">
            <p>&copy; <span th:text="${#dates.year(#dates.createNow())}">2024</span> Playground. All rights reserved.</p>
        </div>
    </footer>

    <!-- ë©”ë‰´ í† ê¸€ ìŠ¤í¬ë¦½íŠ¸ -->
    <script>
        (function() {
            'use strict';
            
            const hamburgerBtn = document.getElementById('hamburgerBtn');
            const navMenu = document.getElementById('navMenu');
            const menuOverlay = document.getElementById('menuOverlay');
            const body = document.body;
            
            if (!hamburgerBtn || !navMenu || !menuOverlay) {
                console.warn('Menu elements not found');
                return;
            }
            
            // ë©”ë‰´ ì—´ê¸°
            function openMenu() {
                hamburgerBtn.classList.add('active');
                navMenu.classList.add('active');
                menuOverlay.classList.add('active');
                body.style.overflow = 'hidden';
                hamburgerBtn.setAttribute('aria-expanded', 'true');
                hamburgerBtn.setAttribute('aria-label', 'ë©”ë‰´ ë‹«ê¸°');
            }
            
            // ë©”ë‰´ ë‹«ê¸°
            function closeMenu() {
                hamburgerBtn.classList.remove('active');
                navMenu.classList.remove('active');
                menuOverlay.classList.remove('active');
                body.style.overflow = '';
                hamburgerBtn.setAttribute('aria-expanded', 'false');
                hamburgerBtn.setAttribute('aria-label', 'ë©”ë‰´ ì—´ê¸°');
            }
            
            // ë©”ë‰´ í† ê¸€
            function toggleMenu() {
                if (hamburgerBtn.classList.contains('active')) {
                    closeMenu();
                } else {
                    openMenu();
                }
            }
            
            // í–„ë²„ê±° ë²„íŠ¼ í´ë¦­
            hamburgerBtn.addEventListener('click', function(e) {
                e.preventDefault();
                e.stopPropagation();
                toggleMenu();
            });
            
            // ì˜¤ë²„ë ˆì´ í´ë¦­ì‹œ ë‹«ê¸°
            menuOverlay.addEventListener('click', function() {
                closeMenu();
            });
            
            // ë©”ë‰´ ë§í¬ í´ë¦­ì‹œ ë‹«ê¸°
            const menuLinks = navMenu.querySelectorAll('.nav-link');
            menuLinks.forEach(function(link) {
                link.addEventListener('click', function() {
                    closeMenu();
                });
            });
            
            // ESC í‚¤ë¡œ ë‹«ê¸°
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && navMenu.classList.contains('active')) {
                    closeMenu();
                }
            });
            
            // ìœˆë„ìš° ë¦¬ì‚¬ì´ì¦ˆì‹œ ë°ìŠ¤í¬íƒ‘ìœ¼ë¡œ ì „í™˜ë˜ë©´ ë©”ë‰´ ë‹«ê¸°
            let resizeTimer;
            window.addEventListener('resize', function() {
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout(function() {
                    if (window.innerWidth > 768 && navMenu.classList.contains('active')) {
                        closeMenu();
                    }
                }, 100);
            });
        })();
        
        // ìŠ¤í¬ë¡¤ì‹œ navbar ê·¸ë¦¼ìž íš¨ê³¼
        (function() {
            const navbar = document.querySelector('.navbar');
            if (!navbar) return;
            
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 10) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
            }, { passive: true });
        })();
    </script>
    
    <th:block layout:fragment="extra-js"></th:block>
</body>
</html>