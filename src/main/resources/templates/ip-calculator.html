<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>IP ê³„ì‚°ê¸°</title>
    <th:block layout:fragment="extra-css">
        <link rel="stylesheet" th:href="@{/css/tool-page.css}">
        <style>
            .examples {
                background: #e7f3ff;
            }
            .examples h4 {
                color: #004085;
            }
        </style>
    </th:block>
</head>
<body>
    <div layout:fragment="content">
        <div class="tool-container">
            <div class="page-header">
                <h2>ğŸŒ IP / ì„œë¸Œë„· ê³„ì‚°ê¸°</h2>
                <p class="description">CIDR í‘œê¸°ë²•ìœ¼ë¡œ IP ë²”ìœ„ì™€ ì„œë¸Œë„· ì •ë³´ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
            </div>

            <div class="tool-section">
                <div class="input-group">
                    <label>CIDR í‘œê¸°ë²•</label>
                    <input type="text" id="cidrInput" placeholder="ì˜ˆ: 192.168.1.0/24">
                    <div class="helper-text">í˜•ì‹: IPì£¼ì†Œ/í”„ë¦¬í”½ìŠ¤ê¸¸ì´ (ì˜ˆ: 192.168.1.0/24)</div>
                </div>
                <button class="btn btn-primary" onclick="calculateCidr()">ê³„ì‚°í•˜ê¸°</button>

                <div id="resultArea" style="display: none; margin-top: 1.5rem;">
                    <h3>ê³„ì‚° ê²°ê³¼</h3>
                    <div class="result-grid">
                        <div class="result-item">
                            <div class="result-label">IP ì£¼ì†Œ</div>
                            <div class="result-value" id="ipAddress"></div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">IP í´ë˜ìŠ¤ / íƒ€ì…</div>
                            <div class="result-value" id="ipClass"></div>
                            <div id="ipTypeBadge"></div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">ì„œë¸Œë„· ë§ˆìŠ¤í¬</div>
                            <div class="result-value" id="subnetMask"></div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">ì™€ì¼ë“œì¹´ë“œ ë§ˆìŠ¤í¬</div>
                            <div class="result-value" id="wildcardMask"></div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ</div>
                            <div class="result-value" id="networkAddress"></div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">ë¸Œë¡œë“œìºìŠ¤íŠ¸ ì£¼ì†Œ</div>
                            <div class="result-value" id="broadcastAddress"></div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">ì²« ë²ˆì§¸ í˜¸ìŠ¤íŠ¸</div>
                            <div class="result-value" id="firstHost"></div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">ë§ˆì§€ë§‰ í˜¸ìŠ¤íŠ¸</div>
                            <div class="result-value" id="lastHost"></div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">ì „ì²´ í˜¸ìŠ¤íŠ¸ ìˆ˜</div>
                            <div class="result-value" id="totalHosts"></div>
                        </div>
                        <div class="result-item">
                            <div class="result-label">ì‚¬ìš© ê°€ëŠ¥í•œ í˜¸ìŠ¤íŠ¸ ìˆ˜</div>
                            <div class="result-value" id="usableHosts"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="examples">
                <h4>ìì£¼ ì‚¬ìš©í•˜ëŠ” CIDR ì˜ˆì œ (í´ë¦­í•˜ì—¬ ì…ë ¥)</h4>
                <div class="example-item" onclick="fillExample('192.168.1.0/24')">192.168.1.0/24 - Class C ì‚¬ì„¤ë§</div>
                <div class="example-item" onclick="fillExample('10.0.0.0/8')">10.0.0.0/8 - Class A ì‚¬ì„¤ë§</div>
                <div class="example-item" onclick="fillExample('172.16.0.0/12')">172.16.0.0/12 - Class B ì‚¬ì„¤ë§</div>
                <div class="example-item" onclick="fillExample('203.0.113.0/24')">203.0.113.0/24 - ê³µì¸ IP ì˜ˆì œ</div>
                <div class="example-item" onclick="fillExample('192.168.1.0/28')">192.168.1.0/28 - ì†Œí˜• ì„œë¸Œë„· (16ê°œ ì£¼ì†Œ)</div>
                <div class="example-item" onclick="fillExample('192.168.1.0/30')">192.168.1.0/30 - Point-to-Point (4ê°œ ì£¼ì†Œ)</div>
            </div>
        </div>
    </div>

    <th:block layout:fragment="extra-js">
        <script>
            async function calculateCidr() {
                const cidr = document.getElementById('cidrInput').value;
                
                if (!cidr) {
                    alert('CIDR í‘œê¸°ë²•ì„ ì…ë ¥í•˜ì„¸ìš”.');
                    return;
                }
                
                try {
                    const response = await fetch('/ip-calculator/api/calculate', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ cidr: cidr })
                    });
                    
                    const data = await response.json();
                    
                    if (data.success) {
                        displayResults(data);
                    } else {
                        alert(data.message);
                    }
                } catch (error) {
                    console.error('ê³„ì‚° ì˜¤ë¥˜:', error);
                    alert('ê³„ì‚° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            }

            function displayResults(data) {
                document.getElementById('ipAddress').textContent = data.ipAddress + '/' + data.prefixLength;
                document.getElementById('ipClass').textContent = 'Class ' + data.ipClass;
                document.getElementById('subnetMask').textContent = data.subnetMask;
                document.getElementById('wildcardMask').textContent = data.wildcardMask;
                document.getElementById('networkAddress').textContent = data.networkAddress;
                document.getElementById('broadcastAddress').textContent = data.broadcastAddress;
                document.getElementById('firstHost').textContent = data.firstHost;
                document.getElementById('lastHost').textContent = data.lastHost;
                document.getElementById('totalHosts').textContent = data.totalHosts.toLocaleString();
                document.getElementById('usableHosts').textContent = data.usableHosts.toLocaleString();
                
                const ipTypeBadge = document.getElementById('ipTypeBadge');
                let badgeClass = 'public';
                if (data.ipType.includes('ì‚¬ì„¤')) badgeClass = 'private';
                else if (data.ipType.includes('ë¡œì»¬')) badgeClass = 'loopback';
                
                ipTypeBadge.innerHTML = `<span class="ip-type-badge ${badgeClass}">${data.ipType}</span>`;
                
                document.getElementById('resultArea').style.display = 'block';
            }

            function fillExample(cidr) {
                document.getElementById('cidrInput').value = cidr;
                calculateCidr();
            }
        </script>
    </th:block>
</body>
</html>