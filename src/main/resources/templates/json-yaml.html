<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>JSON â†” YAML ë³€í™˜</title>
    <th:block layout:fragment="extra-css">
        <link rel="stylesheet" th:href="@{/css/tool-page.css}">
        <style>
            .tool-container {
                max-width: 1200px;
            }
            .converter-layout {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1.5rem;
            }
            .converter-panel {
                background: white;
                padding: 1.5rem;
                border-radius: 6px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .panel-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 1rem;
            }
            .panel-header h3 {
                margin: 0;
                color: #495057;
            }
            .text-area-group textarea {
                width: 100%;
                min-height: 400px;
                padding: 0.75rem;
                border: 1px solid #ced4da;
                border-radius: 4px;
                font-size: 0.9rem;
                font-family: 'Courier New', monospace;
                resize: vertical;
            }
            .examples {
                background: #e7f3ff;
            }
            .examples h4 {
                color: #004085;
            }
            @media (max-width: 768px) {
                .converter-layout {
                    grid-template-columns: 1fr;
                }
            }
        </style>
    </th:block>
</head>
<body>
    <div layout:fragment="content">
        <div class="tool-container">
            <div class="page-header">
                <h2>ğŸ”„ JSON â†” YAML ë³€í™˜ê¸°</h2>
                <p class="description">JSONê³¼ YAML í˜•ì‹ì„ ìƒí˜¸ ë³€í™˜í•©ë‹ˆë‹¤.</p>
            </div>

            <div class="converter-layout">
                <!-- JSON Panel -->
                <div class="converter-panel">
                    <div class="panel-header">
                        <h3>JSON</h3>
                        <div>
                            <button class="format-btn" onclick="formatJson()">í¬ë§·íŒ…</button>
                            <button class="clear-btn" onclick="clearJson()">Clear</button>
                        </div>
                    </div>
                    <div class="text-area-group">
                        <textarea id="jsonInput" placeholder='{"key": "value"}'></textarea>
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('jsonInput')">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
                </div>

                <!-- YAML Panel -->
                <div class="converter-panel">
                    <div class="panel-header">
                        <h3>YAML</h3>
                        <button class="clear-btn" onclick="clearYaml()">Clear</button>
                    </div>
                    <div class="text-area-group">
                        <textarea id="yamlInput" placeholder="key: value"></textarea>
                    </div>
                    <button class="copy-btn" onclick="copyToClipboard('yamlInput')">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
                </div>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="jsonToYaml()">JSON â†’ YAML</button>
                <button class="btn btn-primary" onclick="yamlToJson()">YAML â†’ JSON</button>
            </div>

            <div id="errorMessage" class="error-message"></div>

            <div class="examples">
                <h4>ìì£¼ ì‚¬ìš©í•˜ëŠ” ì˜ˆì œ (í´ë¦­í•˜ì—¬ ì…ë ¥)</h4>
                <div class="example-item" onclick="fillJsonExample1()">ê°„ë‹¨í•œ JSON ê°ì²´</div>
                <div class="example-item" onclick="fillJsonExample2()">ë°°ì—´ì„ í¬í•¨í•œ JSON</div>
                <div class="example-item" onclick="fillYamlExample()">YAML ì„¤ì • íŒŒì¼ ì˜ˆì œ</div>
            </div>
        </div>
    </div>

    <th:block layout:fragment="extra-js">
        <script>
            async function jsonToYaml() {
                const json = document.getElementById('jsonInput').value;
                if (!json) {
                    showError('JSON ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                    return;
                }
                
                try {
                    const response = await fetch('/json-yaml/api/json-to-yaml', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ input: json })
                    });
                    
                    const data = await response.json();
                    if (data.success) {
                        document.getElementById('yamlInput').value = data.result;
                        hideError();
                    } else {
                        showError(data.message + (data.details ? '\n\nìƒì„¸: ' + data.details : ''));
                    }
                } catch (error) {
                    console.error('ë³€í™˜ ì˜¤ë¥˜:', error);
                    showError('ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            }

            async function yamlToJson() {
                const yaml = document.getElementById('yamlInput').value;
                if (!yaml) {
                    showError('YAML ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                    return;
                }
                
                try {
                    const response = await fetch('/json-yaml/api/yaml-to-json', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ input: yaml })
                    });
                    
                    const data = await response.json();
                    if (data.success) {
                        document.getElementById('jsonInput').value = data.result;
                        hideError();
                    } else {
                        showError(data.message + (data.details ? '\n\nìƒì„¸: ' + data.details : ''));
                    }
                } catch (error) {
                    console.error('ë³€í™˜ ì˜¤ë¥˜:', error);
                    showError('ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            }

            async function formatJson() {
                const json = document.getElementById('jsonInput').value;
                if (!json) {
                    showError('JSON ë°ì´í„°ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                    return;
                }
                
                try {
                    const response = await fetch('/json-yaml/api/format-json', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ input: json })
                    });
                    
                    const data = await response.json();
                    if (data.success) {
                        document.getElementById('jsonInput').value = data.result;
                        hideError();
                    } else {
                        showError(data.message + (data.details ? '\n\nìƒì„¸: ' + data.details : ''));
                    }
                } catch (error) {
                    console.error('í¬ë§·íŒ… ì˜¤ë¥˜:', error);
                    showError('í¬ë§·íŒ… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            }

            function clearJson() {
                document.getElementById('jsonInput').value = '';
                hideError();
            }

            function clearYaml() {
                document.getElementById('yamlInput').value = '';
                hideError();
            }

            function copyToClipboard(elementId) {
                const textarea = document.getElementById(elementId);
                textarea.select();
                document.execCommand('copy');
                alert('ë³µì‚¬í–ˆìŠµë‹ˆë‹¤!');
            }

            function showError(message) {
                const errorDiv = document.getElementById('errorMessage');
                errorDiv.textContent = message;
                errorDiv.classList.add('show');
            }

            function hideError() {
                const errorDiv = document.getElementById('errorMessage');
                errorDiv.classList.remove('show');
            }

            function fillJsonExample1() {
                document.getElementById('jsonInput').value = `{
  "name": "John Doe",
  "age": 30,
  "email": "john@example.com",
  "active": true
}`;
                hideError();
            }

            function fillJsonExample2() {
                document.getElementById('jsonInput').value = `{
  "users": [
    {
      "id": 1,
      "name": "Alice"
    },
    {
      "id": 2,
      "name": "Bob"
    }
  ],
  "total": 2
}`;
                hideError();
            }

            function fillYamlExample() {
                document.getElementById('yamlInput').value = `server:
  port: 8080
  address: localhost

database:
  host: localhost
  port: 5432
  name: mydb
  credentials:
    username: admin
    password: secret

features:
  - authentication
  - logging
  - monitoring`;
                hideError();
            }
        </script>
    </th:block>
</body>
</html>